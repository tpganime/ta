<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fusion Hub â€“ Home with FusionBot</title>
  <style>
    :root { 
      --bg-start: #aeecdb; 
      --bg-end: #d0f5ea; 
      --item-bg: rgba(255,255,255,0.95); 
      --shadow: rgba(0,0,0,0.15); 
      --hover: rgba(0,0,0,0.25); 
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body { 
      font-family: Roboto, sans-serif; 
      background: linear-gradient(135deg, var(--bg-start), var(--bg-end)); 
      overflow-x: hidden; 
    }
    .container { padding: 2rem; text-align: center; }
    .app-grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); 
      gap: 18px; 
      max-width: 800px; 
      margin: 0 auto; 
    }
    .app-item { 
      background: var(--item-bg); 
      border-radius: 10px; 
      padding: 15px; 
      text-align: center; 
      box-shadow: 0 3px 8px var(--shadow); 
      cursor: pointer; 
      transition: transform .35s, box-shadow .35s; 
    }
    .app-item:hover { 
      transform: scale(1.02); 
      box-shadow: 0 6px 16px var(--hover); 
    }
    .app-item img { width: 55px; height: 55px; margin-bottom: 8px; }
    .app-item span { font-weight: 700; }
    #fusionBot { 
      position: fixed; 
      bottom: 100px; 
      right: 20px; 
      width: 100px; 
      height: 100px; 
      background: #ffffffcc; 
      border-radius: 50%; 
      box-shadow: 0 3px 8px rgba(0,0,0,0.3); 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      opacity: 0; 
      pointer-events: none; 
      transition: opacity .3s; 
    }
    #fusionBot.active { opacity: 1; }
    #fusionBot img { width: 80px; height: 80px; }
    #speechBubble { 
      position: fixed; 
      bottom: 210px; 
      right: 130px; 
      max-width: 250px; 
      padding: 10px; 
      background: #fff; 
      border-radius: 10px; 
      box-shadow: 0 3px 8px rgba(0,0,0,0.2); 
      font-size: 14px; 
      opacity: 0; 
      transition: opacity .3s; 
    }
    #speechBubble.active { opacity: 1; }
    #micButton { 
      position: fixed; 
      bottom: 80px; 
      right: 20px; 
      background: #00796b; 
      color: #fff; 
      border: none; 
      padding: 15px; 
      border-radius: 50%; 
      font-size: 20px; 
      box-shadow: 0 4px 8px rgba(0,0,0,0.3); 
      cursor: pointer; 
      z-index: 1000; 
    }
    #micButton.granted { background: #004d40; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Welcome to Fusion Hub!</h1>
    <p>Click ðŸŽ¤ to enable voice commands.</p>
    <div class="app-grid">
      <div class="app-item" onclick="openLink('https://chat.openai.com/')">
        <img src="gpt.png" alt="ChatGPT">
        <span>ChatGPT</span>
      </div>
      <div class="app-item" onclick="openLink('https://m.soundcloud.com/')">
        <img src="music.png" alt="Music">
        <span>Music</span>
      </div>
      <div class="app-item" onclick="openLink('https://www.crazygames.com/')">
        <img src="games.jpg" alt="Game Server 1">
        <span>Game Server&nbsp;1</span>
      </div>
      <div class="app-item" onclick="openLink('https://poki.com/')">
        <img src="games.jpg" alt="Game Server 2">
        <span>Game Server&nbsp;2</span>
      </div>
      <div class="app-item" onclick="openLink('https://9anime.org.lv/')">
        <img src="Anime.jpg" alt="Anime">
        <span>Anime</span>
      </div>
    </div>
  </div>

  <button id="micButton">ðŸŽ¤</button>
  <div id="fusionBot"><img src="ai.gif" alt="FusionBot"></div>
  <div id="speechBubble"></div>

  <script>
    function openLink(url) {
      window.location.href = url;
    }

    function saveUserProfile(name, gender) {
      const profile = { name, gender };
      localStorage.setItem("userProfile", JSON.stringify(profile));
    }

    function getUserProfile() {
      const profile = localStorage.getItem("userProfile");
      return profile ? JSON.parse(profile) : null;
    }

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = new SpeechRecognition();
    recognition.continuous = true;
    recognition.interimResults = false;
    recognition.lang = 'en-US';

    let micAllowed = false;
    let micInitialized = false;
    let voices = [];
    speechSynthesis.onvoiceschanged = () => { 
      voices = speechSynthesis.getVoices().filter(v => v.lang.startsWith('en'));
    };
    voices = speechSynthesis.getVoices().filter(v => v.lang.startsWith('en'));

    function getBestVoice() {
      return voices.find(v => /natural|google|enhanced|neural/i.test(v.name)) || voices[0];
    }

    function speak(text) {
      const msg = new SpeechSynthesisUtterance(text);
      msg.voice = getBestVoice();
      msg.lang = 'en-US';
      speechSynthesis.speak(msg);
      showBubble(text);
    }

    const micBtn = document.getElementById('micButton');
    const bot = document.getElementById('fusionBot');
    const bubble = document.getElementById('speechBubble');

    function showBubble(txt) {
      bubble.textContent = txt;
      bubble.classList.add('active');
      clearTimeout(bubble._t);
      bubble._t = setTimeout(() => bubble.classList.remove('active'), 4000);
    }

    function initiateUserSetup() {
      setupMode = true;
      setupStage = "askName";
      speak("Welcome to Fusion Hub. Please tell me your name.");
    }

    let setupMode = false;
    let setupStage = "";
    let tempName = "";

    micBtn.addEventListener('click', async () => {
      if (!micInitialized) {
        try {
          const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
          stream.getTracks().forEach(track => track.stop());
          micAllowed = true;
          micInitialized = true;
          micBtn.classList.add('granted');
          speak("Microphone access granted. You can now use voice commands.");
        } catch (err) {
          alert('Microphone access denied.');
          console.error(err);
          return;
        }
      } else {
        if (!getUserProfile() && !setupMode) {
          initiateUserSetup();
        }
        if (micBtn.textContent === 'ðŸ”´') {
          recognition.stop();
          micBtn.textContent = 'ðŸŽ¤';
        } else {
          recognition.start();
          micBtn.textContent = 'ðŸ”´';
        }
      }
    });

    recognition.onresult = event => {
      const text = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();
      console.log('Command:', text);
      bot.classList.add('active');

      if (setupMode) {
        if (setupStage === "askName") {
          tempName = text;
          speak("Thank you, " + tempName + ". Please tell me your gender.");
          setupStage = "askGender";
          return;
        } else if (setupStage === "askGender") {
          const gender = text;
          saveUserProfile(tempName, gender);
          speak("Hello " + tempName + "! Your profile has been set up.");
          setupMode = false;
          setupStage = "";
          return;
        }
      }

      if (text.includes('open music')) {
        speak('Opening music');
        openLink('https://m.soundcloud.com/');
      } else if (text.includes('open game server 1')) {
        speak('Opening server one');
        openLink('https://www.crazygames.com/');
      } else if (text.includes('open game server 2')) {
        speak('Opening server two');
        openLink('https://poki.com/');
      } else if (text.includes('open anime')) {
        speak('Opening anime');
        openLink('https://9anime.org.lv/');
      } else if (text.includes('open chatgpt')) {
        speak('Opening ChatGPT');
        openLink('https://chat.openai.com/');
      } else if (['what is time','what is the time','what time it is','what the time it is','what time is it'].some(q => text.includes(q))) {
        const now = new Date();
        const time = now.toLocaleTimeString('en-US', { timeZone: 'Asia/Kolkata' });
        const dateInfo = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', timeZone: 'Asia/Kolkata' });
        speak(`The time is ${time}. Today is ${dateInfo}.`);
      } else if (text.includes('help')) {
        const commands = [
          "Open music", "Open game server 1", "Open game server 2", "Open anime", "Open ChatGPT",
          "What time is it", "Tell me a joke", "Hello", "Hi", "Welcome", "Bye"
        ];
        speak("Here are some things you can say: " + commands.join(", "));
        showBubble("Commands: " + commands.join(", "));
      } else if (text.includes('hello') || text.includes('hi') || text.includes('welcome')) {
        const profile = getUserProfile();
        if (profile && profile.name) {
          speak('Hello ' + profile.name + '! Welcome back.');
        } else {
          speak('Hello there! Welcome.');
        }
      } else if (text.includes('how are you')) {
        speak('I am doing great, thank you!');
      } else if (text.includes('tell me a joke')) {
        const jokes = [
          "Why did the JavaScript developer go broke? Because he kept using promises.",
          "Why don't scientists trust atoms? Because they make up everything!",
          "Why did the scarecrow win an award? Because he was outstanding in his field!",
          "Why donâ€™t programmers like nature? Too many bugs.",
          "Why do Java developers wear glasses? Because they don't C#.",
          "Why was the math book sad? It had too many problems.",
          "Parallel lines have so much in common. Itâ€™s a shame theyâ€™ll never meet.",
          "Why did the computer catch a cold? It left its Windows open.",
          "Why do cows have hooves instead of feet? Because they lactose.",
          "Why did the cookie go to the hospital? Because it felt crummy.",
          "What do you get when you cross a snowman and a vampire? Frostbite.",
          "I told my computer I needed a break, and it said: 'No problem, I'll go to sleep.'",
          "What is a computerâ€™s favorite snack? Microchips!",
          "Why was the robot so tired after his road trip? He had a hard drive.",
          "Why did the smartphone go to therapy? Low self-esteem battery.",
          "What do you call 8 hobbits? A hob-byte.",
          "Why did the function break up with the loop? Too many endless promises.",
          "Why was the website feeling depressed? It had too many 404s.",
          "How does a computer get drunk? It takes screenshots.",
          "Why couldn't the leopard play hide and seek? Because he was always spotted."
        ];
        const randomJoke = jokes[Math.floor(Math.random() * jokes.length)];
        speak(randomJoke);
      } else if (text.includes('bye')) {
        speak('Goodbye! See you later.');
      } else {
        speak("I'm sorry, I didn't understand that.");
      }
    };

    recognition.onend = () => {
      if (micAllowed && micBtn.textContent === 'ðŸ”´') {
        setTimeout(() => recognition.start(), 500);
      }
    };

    recognition.onerror = err => console.error(err.error);
  </script>
</body>
</html>
